<BehaviorTree>
  <Variables>
    <Variable name="Hungry"/>
    <Variable name="AwareOfEnemy"/>
    <Variable name="SeenByEnemy" />
    <Variable name="AwareOfFood"/>
    <Variable name="ExecuteSequence" />
    <Variable name="ExecuteInterruptibleSequence" />
  </Variables>
  
  <SignalVariables>
    <Signal name="OnEnemySeen" variable="AwareOfEnemy" value="true"/>
    <Signal name="OnMealComplete" variable="Hungry" value="false" />
    <Signal name="OnNoTarget" variable="AwareOfEnemy" value="false" />
  </SignalVariables>
  
  <Timestamps />
  
  <Root>

    <StateMachine>

      <!--
      =================================================
          Idle
      =================================================
      -->

      <State name="Idle">

        <Transitions>
          <Transition to="MouseAvoid" onEvent="OnEnemySeen"/>
          <Transition to="MouseEat" onEvent="OnObjectSeen"/>
        </Transitions>

        <BehaviorTree>

          <Sequence>

            <SetAlertness value="0"/>

            <!--<ExecuteLua code="entity:MouseIdle()"/>-->
            <Bubble message="Idle" duration="3" />

            <Stance name="Relaxed"/>


            <Halt/>

          </Sequence>

        </BehaviorTree>

      </State>


      <State name="MouseAvoid">

        <Transitions>
          <Transition to="Idle" onEvent="OnLostSightOfTarget"/>
          <Transition to="MouseEat" onEvent="OnObjectSeen"/>
        </Transitions>

        <BehaviorTree>

          <Sequence>


            <SetAlertness value="2"/>

            <Stance name="Alerted"/>

            <!--<ExecuteLua code="entity:MouseAvoid()"/>-->
            <Bubble message="Avoid" duration="3" />

            <Halt />

          </Sequence>

        </BehaviorTree>

      </State>

      <State name="MouseEat">

        <Transitions>
          <Transition to="MouseAvoid" onEvent="OnEnemySeen"/>
          <Transition to="Idle" onEvent="OnLostSightOfTarget"/>
        </Transitions>

        <BehaviorTree>

          <Sequence>


            <SetAlertness value="2"/>

            <Stance name="Relaxed"/>

            <!--<ExecuteLua code="entity:MouseEat()"/>-->
            <Bubble message="Eat" duration="3" />

            <Halt />

          </Sequence>

        </BehaviorTree>

      </State>

    </StateMachine>
  </Root>
 
</BehaviorTree>